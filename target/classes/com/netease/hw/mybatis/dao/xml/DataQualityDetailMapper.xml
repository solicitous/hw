<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yscredit.pgp.mybatis.dao.DataQualityDetailMapper" >
  <resultMap id="BaseResultMap" type="com.yscredit.pgp.mybatis.model.DataQualityDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="DEPT_CODE" property="deptCode" jdbcType="INTEGER" />
    <result column="DATA_INFO_CODE" property="dataInfoCode" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="DATE" />
    <result column="EXACT" property="exact" jdbcType="INTEGER" />
    <result column="FULL" property="full" jdbcType="INTEGER" />
    <result column="STANDARD" property="standard" jdbcType="INTEGER" />
    <result column="UNIQUENESS" property="uniqueness" jdbcType="INTEGER" />
    <result column="RELEVANCE" property="relevance" jdbcType="INTEGER" />
    <result column="GLOBAL" property="global" jdbcType="INTEGER" />
  </resultMap>


    <resultMap id="DataGlobalQualityDetail" type="com.yscredit.pgp.mybatis.model.DataGlobalQualityDetail">
      <result column="DEPT_CODE" property="deptCode" jdbcType="INTEGER"/>
      <result column="AVG_GLOBAL" property="avgGlobal" jdbcType="FLOAT"/>
    </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    ID, DEPT_CODE, DATA_INFO_CODE, CREATE_DATE, EXACT, FULL, STANDARD, UNIQUENESS, RELEVANCE, GLOBAL
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from data_quality_detail
    where ID = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    delete from data_quality_detail
    where ID = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.yscredit.pgp.mybatis.model.DataQualityDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    insert into data_quality_detail (ID, DEPT_CODE,DATA_INFO_CODE, CREATE_DATE, 
      EXACT, FULL, STANDARD, 
      UNIQUENESS, RELEVANCE, GLOBAL
      )
    values (#{id,jdbcType=INTEGER}, #{deptCode,jdbcType=INTEGER}, #{dataInfoCode,jdbcType=VARCHAR}, #{createDate,jdbcType=DATE}, 
      #{exact,jdbcType=INTEGER}, #{full,jdbcType=INTEGER}, #{standard,jdbcType=INTEGER}, 
      #{uniqueness,jdbcType=INTEGER}, #{relevance,jdbcType=INTEGER}, #{global,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.yscredit.pgp.mybatis.model.DataQualityDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    insert into data_quality_detail
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID,
      </if>
      <if test="deptCode != null" >
        DEPT_CODE,
      </if>
      <if test="dataInfoCode != null" >
        DATA_INFO_CODE,
      </if>
      <if test="createDate != null" >
        CREATE_DATE,
      </if>
      <if test="exact != null" >
        EXACT,
      </if>
      <if test="full != null" >
        FULL,
      </if>
      <if test="standard != null" >
        STANDARD,
      </if>
      <if test="uniqueness != null" >
        UNIQUENESS,
      </if>
      <if test="relevance != null" >
        RELEVANCE,
      </if>
      <if test="global != null" >
        GLOBAL,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="deptCode != null" >
        #{deptCode,jdbcType=INTEGER},
      </if>
      <if test="dataInfoCode != null" >
        #{dataInfoCode,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        #{createDate,jdbcType=DATE},
      </if>
      <if test="exact != null" >
        #{exact,jdbcType=INTEGER},
      </if>
      <if test="full != null" >
        #{full,jdbcType=INTEGER},
      </if>
      <if test="standard != null" >
        #{standard,jdbcType=INTEGER},
      </if>
      <if test="uniqueness != null" >
        #{uniqueness,jdbcType=INTEGER},
      </if>
      <if test="relevance != null" >
        #{relevance,jdbcType=INTEGER},
      </if>
      <if test="global != null" >
        #{global,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.yscredit.pgp.mybatis.model.DataQualityDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    update data_quality_detail
    <set >
      <if test="deptCode != null" >
        DEPT_CODE = #{deptCode,jdbcType=INTEGER},
      </if>
       <if test="dataInfoCode != null" >
        DATA_INFO_CODE = #{dataInfoCode,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null" >
        CREATE_DATE = #{createDate,jdbcType=DATE},
      </if>
      <if test="exact != null" >
        EXACT = #{exact,jdbcType=INTEGER},
      </if>
      <if test="full != null" >
        FULL = #{full,jdbcType=INTEGER},
      </if>
      <if test="standard != null" >
        STANDARD = #{standard,jdbcType=INTEGER},
      </if>
      <if test="uniqueness != null" >
        UNIQUENESS = #{uniqueness,jdbcType=INTEGER},
      </if>
      <if test="relevance != null" >
        RELEVANCE = #{relevance,jdbcType=INTEGER},
      </if>
      <if test="global != null" >
        GLOBAL = #{global,jdbcType=INTEGER},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.yscredit.pgp.mybatis.model.DataQualityDetail" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Dec 06 16:15:27 CST 2016.
    -->
    update data_quality_detail
    set DEPT_CODE = #{deptCode,jdbcType=INTEGER},
    	DATA_INFO_CODE = #{dataInfoCode,jdbcType=VARCHAR},
      CREATE_DATE = #{createDate,jdbcType=DATE},
      EXACT = #{exact,jdbcType=INTEGER},
      FULL = #{full,jdbcType=INTEGER},
      STANDARD = #{standard,jdbcType=INTEGER},
      UNIQUENESS = #{uniqueness,jdbcType=INTEGER},
      RELEVANCE = #{relevance,jdbcType=INTEGER},
      GLOBAL = #{global,jdbcType=INTEGER}
    where ID = #{id,jdbcType=INTEGER}
  </update>
    <select id="selectDeptOfBestAndLast" resultMap="DataGlobalQualityDetail">
      select AVG(GLOBAL) as AVG_GLOBAL,dept_code
      from data_quality_detail WHERE CREATE_DATE=date_format(now(),'%Y-%m-%d')
      GROUP BY dept_code
      order by avg(global)
      ${condition}
       limit  #{limit}
    </select>



  <select id="ListDeptOfBestAndLast" resultMap="BaseResultMap">
      SELECT * FROM data_quality_detail WHERE DEPT_CODE = #{deptCode} and CREATE_DATE = date_format(now(),'%Y-%m-%d')
    </select>



  <select id="ListDeptQuality" resultMap="BaseResultMap">
    SELECT avg(EXACT) as EXACT,avg(FULL) AS FULL,avg(STANDARD) AS STANDERD,
    avg(UNIQUENESS) AS UNIQENESS,avg(RELEVANCE) AS RELEVANCE,
    avg(GLOBAL) AS GLOBAL
    FROM data_quality_detail
    WHERE DEPT_CODE = #{deptCode} and CREATE_DATE = date_format(now(),'%Y-%m-%d')
  </select>

</mapper>
